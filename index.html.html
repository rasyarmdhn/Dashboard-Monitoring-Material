
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Monitoring Dead Stock - PT Pertamina Hulu Rokan Zona 4</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #1e3a5f;
            --secondary-blue: #2563eb;
            --accent-orange: #ff8c00;
            --accent-red: #ef4444;
            --accent-green: #10b981;
            --accent-yellow: #f59e0b;
            --light-gray: #f3f4f6;
            --dark-gray: #1f2937;
            --border-color: #e5e7eb;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e3a5f 100%);
            color: var(--dark-gray);
            min-height: 100vh;
            padding: 20px;
        }

        /* LOGIN PAGE STYLES */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #0f172a 0%, #1e3a5f 100%);
        }

        .login-box {
            background: white;
            border-radius: 16px;
            padding: 50px 40px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            width: 100%;
            max-width: 400px;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .login-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .login-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #1e3a5f, #2563eb);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 32px;
            margin: 0 auto 20px;
            box-shadow: 0 5px 20px rgba(37, 99, 235, 0.3);
        }

        .login-header h1 {
            font-size: 24px;
            color: var(--primary-blue);
            margin-bottom: 8px;
        }

        .login-header p {
            font-size: 13px;
            color: #666;
            line-height: 1.6;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: var(--primary-blue);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
            background: #f9fafb;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--secondary-blue);
            background: white;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-group input::placeholder {
            color: #aaa;
        }

        .login-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #1e3a5f, #2563eb);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(37, 99, 235, 0.4);
        }

        .login-btn:active {
            transform: translateY(0);
        }

        .login-error {
            background: #fee2e2;
            border: 1px solid #fca5a5;
            color: #991b1b;
            padding: 12px 15px;
            border-radius: 8px;
            font-size: 13px;
            margin-bottom: 20px;
            display: none;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .remember-me {
            display: flex;
            align-items: center;
            font-size: 12px;
            margin-top: 15px;
        }

        .remember-me input {
            width: auto;
            margin-right: 8px;
            cursor: pointer;
        }

        .login-footer {
            text-align: center;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            font-size: 11px;
            color: #999;
        }

        /* DASHBOARD PAGE STYLES */
        .dashboard-hidden {
            display: none;
        }

        .login-hidden {
            display: none;
        }

        .container {
            max-width: 1920px;
            margin: 0 auto;
        }

        /* HEADER */
        .header {
            background: white;
            border-radius: 12px;
            padding: 25px 30px;
            margin-bottom: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 4px solid var(--secondary-blue);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-logo {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #1e3a5f, #2563eb);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 24px;
        }

        .header-text h1 {
            font-size: 24px;
            color: var(--primary-blue);
            margin-bottom: 5px;
        }

        .header-text p {
            font-size: 12px;
            color: #666;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
            text-align: right;
            font-size: 13px;
            color: #666;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #1e3a5f, #2563eb);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 16px;
        }

        .logout-btn {
            padding: 8px 16px;
            background: var(--accent-red);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }

        .update-time {
            font-weight: bold;
            color: var(--secondary-blue);
        }

        /* KPI CARDS */
        .kpi-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .kpi-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 4px solid var(--secondary-blue);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
        }

        .kpi-card.red { border-left-color: var(--accent-red); }
        .kpi-card.orange { border-left-color: var(--accent-orange); }
        .kpi-card.green { border-left-color: var(--accent-green); }
        .kpi-card.blue { border-left-color: var(--secondary-blue); }

        .kpi-label {
            font-size: 12px;
            color: #666;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .kpi-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--dark-gray);
        }

        .kpi-value.red { color: var(--accent-red); }
        .kpi-value.orange { color: var(--accent-orange); }
        .kpi-value.green { color: var(--accent-green); }
        .kpi-value.blue { color: var(--secondary-blue); }

        .kpi-sublabel {
            font-size: 11px;
            color: #999;
        }

        /* CHARTS GRID */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .charts-grid-full {
            grid-template-columns: 1fr;
        }

        .chart-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .chart-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart-icon {
            width: 24px;
            height: 24px;
            background: var(--light-gray);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .chart-container {
            position: relative;
            height: 350px;
            margin-bottom: 15px;
        }

        .chart-info {
            font-size: 12px;
            color: #666;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
        }

        /* DATA TABLE */
        .table-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 25px;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .table-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--primary-blue);
        }

        .table-controls {
            display: flex;
            gap: 10px;
        }

        .filter-btn, .export-btn {
            padding: 8px 16px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
        }

        .filter-btn:hover, .export-btn:hover {
            border-color: var(--secondary-blue);
            color: var(--secondary-blue);
            background: #f0f6ff;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .data-table thead {
            background: var(--light-gray);
        }

        .data-table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: var(--primary-blue);
            border-bottom: 2px solid var(--border-color);
        }

        .data-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .data-table tbody tr:hover {
            background: #f9f9f9;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-a {
            background: #fee2e2;
            color: #991b1b;
        }

        .badge-b {
            background: #fef3c7;
            color: #92400e;
        }

        .badge-c {
            background: #dbeafe;
            color: #1e40af;
        }

        .badge-good {
            background: #d1fae5;
            color: #065f46;
        }

        .badge-warning {
            background: #fef3c7;
            color: #92400e;
        }

        .badge-danger {
            background: #fee2e2;
            color: #991b1b;
        }

        /* ALERTS */
        .alert-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .alert-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 4px solid;
        }

        .alert-card.critical { border-left-color: var(--accent-red); }
        .alert-card.warning { border-left-color: var(--accent-orange); }
        .alert-card.info { border-left-color: var(--secondary-blue); }

        .alert-title {
            font-size: 13px;
            font-weight: 700;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .alert-title.critical { color: var(--accent-red); }
        .alert-title.warning { color: var(--accent-orange); }
        .alert-title.info { color: var(--secondary-blue); }

        .alert-count {
            font-size: 28px;
            font-weight: 700;
            margin: 10px 0;
        }

        .alert-count.critical { color: var(--accent-red); }
        .alert-count.warning { color: var(--accent-orange); }
        .alert-count.info { color: var(--secondary-blue); }

        .alert-action {
            font-size: 11px;
            color: #666;
            padding-top: 10px;
            border-top: 1px solid var(--border-color);
        }

        /* FOOTER */
        .footer {
            text-align: center;
            color: white;
            font-size: 12px;
            padding: 20px 0;
            border-top: 1px solid rgba(255,255,255,0.2);
        }

        /* RESPONSIVE */
        @media (max-width: 1200px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                text-align: center;
            }
            .kpi-container {
                grid-template-columns: 1fr;
            }
            .data-table {
                font-size: 11px;
            }
            .data-table th, .data-table td {
                padding: 10px;
            }
            .login-box {
                padding: 40px 25px;
            }
        }

        /* PRINT STYLE */
        @media print {
            body {
                background: white;
            }
            .chart-card, .table-card, .alert-card, .kpi-card {
                box-shadow: none;
                border: 1px solid var(--border-color);
            }
        }

        /* Animation */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .chart-card, .table-card, .kpi-card {
            animation: fadeIn 0.5s ease-out;
        }
    </style>
</head>
<body>
    <!-- LOGIN PAGE -->
    <div class="login-page" id="loginPage">
        <div class="login-container">
            <div class="login-box">
                <div class="login-header">
                    <div class="login-logo">PHR</div>
                    <h1>Dead Stock Monitoring</h1>
                    <p>PT Pertamina Hulu Rokan Zona 4<br>Warehouse Management System</p>
                </div>

                <form id="loginForm" onsubmit="handleLogin(event)">
                    <div class="login-error" id="loginError"></div>

                    <div class="form-group">
                        <label for="username">ID / Username</label>
                        <input 
                            type="text" 
                            id="username" 
                            placeholder="Masukkan ID" 
                            required
                            autocomplete="username"
                        >
                    </div>

                    <div class="form-group">
                        <label for="password">Password</label>
                        <input 
                            type="password" 
                            id="password" 
                            placeholder="Masukkan Password" 
                            required
                            autocomplete="current-password"
                        >
                    </div>

                    <div class="remember-me">
                        <input type="checkbox" id="rememberMe">
                        <label for="rememberMe" style="margin: 0;">Ingat saya di perangkat ini</label>
                    </div>

                    <button type="submit" class="login-btn">üîì LOGIN SEKARANG</button>
                </form>

                <div class="login-footer">
                    <p>Informasi login telah tersimpan aman dengan enkripsi</p>
                    <p style="margin-top: 10px;">¬© 2025 PT Pertamina Hulu Rokan</p>
                </div>
            </div>
        </div>
    </div>

    <!-- DASHBOARD PAGE -->
    <div class="dashboard-page dashboard-hidden" id="dashboardPage">
        <div class="container">
            <!-- HEADER -->
            <div class="header">
                <div class="header-left">
                    <div class="header-logo">PHR</div>
                    <div class="header-text">
                        <h1>Dead Stock Material Analysis</h1>
                        <p>PT Pertamina Hulu Rokan - Zona 4 Warehouse Management</p>
                    </div>
                </div>
                <div class="header-right">
                    <div>
                        <div>Last Updated: <span class="update-time" id="updateTime">13-12-2025 14:02</span></div>
                        <div style="margin-top: 5px;">Data Source: SAP MMIS System</div>
                    </div>
                    <div class="user-info">
                        <div class="user-avatar" id="userInitial">R</div>
                        <div>
                            <div style="font-weight: 600; font-size: 13px; color: var(--dark-gray);" id="userDisplayName">Rasyardhn</div>
                            <div style="font-size: 11px; color: #999;">Logged in</div>
                        </div>
                    </div>
                    <button class="logout-btn" onclick="handleLogout()">Logout</button>
                </div>
            </div>

            <!-- KPI CARDS -->
            <div class="kpi-container">
                <div class="kpi-card red">
                    <div class="kpi-label">üí∞ Total Nilai Dead Stock</div>
                    <div class="kpi-value red">IDR 7.74 M</div>
                    <div class="kpi-sublabel">100 SKU | 6,391 Unit</div>
                </div>
                <div class="kpi-card blue">
                    <div class="kpi-label">üì¶ Kelas A (Prioritas)</div>
                    <div class="kpi-value blue">31 SKU</div>
                    <div class="kpi-sublabel">79.8% dari Total Nilai</div>
                </div>
                <div class="kpi-card orange">
                    <div class="kpi-label">‚ö†Ô∏è Kelas B (Menengah)</div>
                    <div class="kpi-value orange">24 SKU</div>
                    <div class="kpi-sublabel">15.1% dari Total Nilai</div>
                </div>
                <div class="kpi-card green">
                    <div class="kpi-label">üìä Kelas C (Rendah)</div>
                    <div class="kpi-value green">45 SKU</div>
                    <div class="kpi-sublabel">5.1% dari Total Nilai</div>
                </div>
            </div>

            <!-- CHARTS SECTION -->
            <div class="charts-grid">
                <div class="chart-card">
                    <div class="chart-title">
                        <div class="chart-icon">üìà</div>
                        Distribusi ABC Class
                    </div>
                    <div class="chart-container">
                        <canvas id="abcChart"></canvas>
                    </div>
                    <div class="chart-info">Visualisasi prioritas penanganan material berdasarkan kontribusi nilai</div>
                </div>

                <div class="chart-card">
                    <div class="chart-title">
                        <div class="chart-icon">üîç</div>
                        Status Kondisi Material
                    </div>
                    <div class="chart-container">
                        <canvas id="conditionChart"></canvas>
                    </div>
                    <div class="chart-info">Breakdown kondisi fisik material di warehouse</div>
                </div>
            </div>

            <!-- CHARTS SECTION 2 -->
            <div class="charts-grid">
                <div class="chart-card charts-grid-full">
                    <div class="chart-title">
                        <div class="chart-icon">üèÜ</div>
                        Top 10 Material dengan Nilai Tertinggi
                    </div>
                    <div class="chart-container" style="height: 400px;">
                        <canvas id="top10Chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- CHARTS SECTION 3 -->
            <div class="charts-grid">
                <div class="chart-card charts-grid-full">
                    <div class="chart-title">
                        <div class="chart-icon">üè≠</div>
                        Dead Stock by Klasifikasi Material
                    </div>
                    <div class="chart-container" style="height: 400px;">
                        <canvas id="classificationChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- ALERTS SECTION -->
            <div class="alert-container">
                <div class="alert-card critical">
                    <div class="alert-title critical">üî¥ INSPEKSI URGEN</div>
                    <div class="alert-count critical" id="urgentCount">42</div>
                    <div class="alert-action">Material belum diinspeksi >180 hari</div>
                </div>
                <div class="alert-card warning">
                    <div class="alert-title warning">üü° REDISTRIBUSI KELAS A</div>
                    <div class="alert-count warning" id="classACount">31</div>
                    <div class="alert-action">Diprioritaskan untuk recovery value</div>
                </div>
                <div class="alert-card info">
                    <div class="alert-title info">üü¢ MATERIAL BAIK</div>
                    <div class="alert-count info" id="goodCount">37</div>
                    <div class="alert-action">Layak untuk redistribusi/penjualan</div>
                </div>
            </div>

            <!-- DATA TABLE -->
            <div class="table-card">
                <div class="table-header">
                    <div class="table-title">üìã Detail Material Dead Stock</div>
                    <div class="table-controls">
                        <button class="filter-btn">üîç Filter</button>
                        <button class="export-btn" onclick="exportToExcel()">üì• Export to Excel</button>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Material Doc</th>
                            <th>Nama Material</th>
                            <th>Kategori</th>
                            <th>Nilai Total</th>
                            <th>Qty</th>
                            <th>Satuan</th>
                            <th>Kelas ABC</th>
                            <th>Status Kondisi</th>
                            <th>Inspeksi Terakhir</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                    </tbody>
                </table>
            </div>

            <!-- FOOTER -->
            <div class="footer">
                <p>¬© 2025 PT Pertamina Hulu Rokan - Dashboard Monitoring Inventory | Confidential - For Internal Use Only</p>
                <p style="margin-top: 10px; font-size: 11px;">Data updated automatically setiap 1 jam dari SAP MMIS System</p>
            </div>
        </div>
    </div>

    <script>
        // ========== LOGIN AUTHENTICATION ==========
        const VALID_CREDENTIALS = {
            username: 'rasyardhn',
            password: 'Rasya 2003'
        };

        function handleLogin(event) {
            event.preventDefault();

            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const errorDiv = document.getElementById('loginError');

            // Clear previous errors
            errorDiv.style.display = 'none';
            errorDiv.textContent = '';

            // Validate credentials
            if (username === VALID_CREDENTIALS.username && password === VALID_CREDENTIALS.password) {
                // Login successful
                if (document.getElementById('rememberMe').checked) {
                    localStorage.setItem('rememberedUser', username);
                }

                // Set session
                sessionStorage.setItem('isLoggedIn', 'true');
                sessionStorage.setItem('currentUser', username);

                // Show dashboard
                showDashboard();
            } else {
                // Login failed
                errorDiv.textContent = '‚ùå Username atau Password salah. Silakan coba lagi.';
                errorDiv.style.display = 'block';
                document.getElementById('password').value = '';
                document.getElementById('username').focus();
            }
        }

        function handleLogout() {
            if (confirm('Apakah Anda yakin ingin logout?')) {
                sessionStorage.removeItem('isLoggedIn');
                sessionStorage.removeItem('currentUser');
                localStorage.removeItem('rememberedUser');
                showLoginPage();
            }
        }

        function showLoginPage() {
            document.getElementById('loginPage').classList.remove('login-hidden');
            document.getElementById('dashboardPage').classList.add('dashboard-hidden');
            document.getElementById('username').value = localStorage.getItem('rememberedUser') || '';
            document.getElementById('password').value = '';
            document.getElementById('username').focus();
        }

        function showDashboard() {
            const currentUser = sessionStorage.getItem('currentUser');
            document.getElementById('userDisplayName').textContent = currentUser || 'User';
            document.getElementById('userInitial').textContent = currentUser.charAt(0).toUpperCase();

            document.getElementById('loginPage').classList.add('login-hidden');
            document.getElementById('dashboardPage').classList.remove('dashboard-hidden');

            initializeDashboard();
        }

        // Check if already logged in
        window.addEventListener('load', function() {
            if (sessionStorage.getItem('isLoggedIn') === 'true') {
                showDashboard();
            } else {
                showLoginPage();
            }
        });

        // ========== DASHBOARD INITIALIZATION ==========
        function initializeDashboard() {
            const dashboardData = {
                abc: {
                    labels: ['Kelas A', 'Kelas B', 'Kelas C'],
                    values: [31, 24, 45],
                    percentages: [79.8, 15.1, 5.1],
                    colors: ['#ef4444', '#f59e0b', '#2563eb']
                },
                condition: {
                    labels: ['Baik', 'Rusak Minor', 'Degradasi', 'Tidak Layak'],
                    values: [37, 28, 22, 13],
                    colors: ['#10b981', '#f59e0b', '#ef4444', '#7c3aed']
                },
                top10: [
                    { name: 'BUSH, WEARING', value: 508.97, class: 'A' },
                    { name: 'PLUG 2.313IN C/W. PRONG', value: 447.66, class: 'A' },
                    { name: 'JOINT: SAFETY, SHEER AUT', value: 428.73, class: 'A' },
                    { name: 'CHOKE, ADJUSTABLE, STYLE A', value: 370.03, class: 'A' },
                    { name: 'CUP, BOP TESTER', value: 367.50, class: 'A' },
                    { name: 'PLUG, PUMP OUT, 3.1/2IN', value: 346.16, class: 'A' },
                    { name: 'LINER HANGER, 7 IN', value: 318.97, class: 'A' },
                    { name: 'COMBINATION TOOLS BOP', value: 285.73, class: 'A' },
                    { name: 'PLUG, BLANKING, 3.1/2IN', value: 249.39, class: 'A' },
                    { name: 'JOINTING, CAF, 1.5MM', value: 235.32, class: 'A' }
                ],
                classification: {
                    labels: ['Tublr Gds, Valv&Fits', 'Plant & Machinery', 'Tools and Packing', 'Mach Accrs & Instr', 'Bldng, Tnks&sh Eq', 'Transportation', 'Electrical', 'Hoshld, Offc'],
                    values: [4647.03, 837.30, 829.09, 762.74, 549.91, 69.43, 34.27, 11.67]
                }
            };

            // ABC Chart
            const abcCtx = document.getElementById('abcChart').getContext('2d');
            new Chart(abcCtx, {
                type: 'doughnut',
                data: {
                    labels: dashboardData.abc.labels,
                    datasets: [{
                        data: dashboardData.abc.values,
                        backgroundColor: dashboardData.abc.colors,
                        borderColor: 'white',
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { usePointStyle: true, padding: 20, font: { size: 12 } }
                        },
                        datalabels: {
                            color: 'white',
                            font: { weight: 'bold', size: 14 },
                            formatter: (value, ctx) => value + ' SKU\n' + dashboardData.abc.percentages[ctx.dataIndex] + '%'
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });

            // Condition Chart
            const conditionCtx = document.getElementById('conditionChart').getContext('2d');
            new Chart(conditionCtx, {
                type: 'bar',
                data: {
                    labels: dashboardData.condition.labels,
                    datasets: [{
                        label: 'Jumlah Material',
                        data: dashboardData.condition.values,
                        backgroundColor: dashboardData.condition.colors,
                        borderRadius: 8,
                        borderSkipped: false
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: {
                            color: '#000',
                            font: { weight: 'bold', size: 12 },
                            anchor: 'end',
                            align: 'end',
                            offset: 10
                        }
                    },
                    scales: {
                        x: { beginAtZero: true, grid: { display: false } },
                        y: { grid: { display: false } }
                    }
                },
                plugins: [ChartDataLabels]
            });

            // Top 10 Chart
            const top10Ctx = document.getElementById('top10Chart').getContext('2d');
            new Chart(top10Ctx, {
                type: 'bar',
                data: {
                    labels: dashboardData.top10.map(m => m.name.substring(0, 35)),
                    datasets: [{
                        label: 'Nilai (Juta IDR)',
                        data: dashboardData.top10.map(m => m.value),
                        backgroundColor: dashboardData.top10.map(m => m.class === 'A' ? '#ef4444' : m.class === 'B' ? '#f59e0b' : '#2563eb'),
                        borderRadius: 8,
                        borderSkipped: false
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: {
                            color: '#000',
                            font: { weight: 'bold', size: 11 },
                            anchor: 'end',
                            align: 'end',
                            offset: 5,
                            formatter: (value) => 'IDR ' + value.toFixed(1) + 'M'
                        }
                    },
                    scales: {
                        x: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.05)' } },
                        y: { grid: { display: false } }
                    }
                },
                plugins: [ChartDataLabels]
            });

            // Classification Chart
            const classificationCtx = document.getElementById('classificationChart').getContext('2d');
            new Chart(classificationCtx, {
                type: 'bar',
                data: {
                    labels: dashboardData.classification.labels,
                    datasets: [{
                        label: 'Nilai (Juta IDR)',
                        data: dashboardData.classification.values,
                        backgroundColor: [
                            '#3b82f6', '#06b6d4', '#8b5cf6', '#ec4899', '#f59e0b', '#10b981', '#6366f1', '#f43f5e'
                        ],
                        borderRadius: 8,
                        borderSkipped: false
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: {
                            color: '#000',
                            font: { weight: 'bold', size: 11 },
                            anchor: 'end',
                            align: 'end',
                            offset: 5,
                            formatter: (value) => 'IDR ' + value.toFixed(1) + 'M'
                        }
                    },
                    scales: {
                        x: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.05)' } },
                        y: { grid: { display: false } }
                    }
                },
                plugins: [ChartDataLabels]
            });

            // Populate Table
            const tableData = [
                ['1140900197', 'BUSH CARBON, NO. 6A, 4.5 X 32 X 2.7', 'Bldng, Trnks&sh Eq', 'IDR 8,001,829', 36, 'PCS', 'A', 'Baik', '05-11-2025'],
                ['1140900183', 'CHAIR, SPINNING, 1/2 IN X 3 FT', 'Bldng, Trnks&sh Eq', 'IDR 20,885,784', 11, 'PCS', 'A', 'Baik', '15-10-2025'],
                ['1240900004', 'CHOKE, ADJUSTABLE, STYLE A, 3 IN', 'Bldng, Trnks&sh Eq', 'IDR 370,028,571', 12, 'PCS', 'A', 'Rusak Minor', '20-09-2025'],
                ['1260900930', 'CHAIR PISTON ROD', 'Bldng, Trnks&sh Eq', 'IDR 18,739,930', 6, 'PCS', 'B', 'Degradasi', '30-08-2025'],
                ['1560900392', 'ROD PISTON', 'Bldng, Trnks&sh Eq', 'IDR 67,600,000', 4, 'PCS', 'B', 'Baik', '10-07-2025'],
                ['1560500032', 'ROD, VALVE 7/8 x 222', 'Tublr Gds, Valv&Fits', 'IDR 55,574,400', 40, 'EA', 'B', 'Baik', '25-06-2025'],
                ['1560300005', 'ROD, POLISHED, 1 1/2 IN', 'Bldng, Trnks&sh Eq', 'IDR 8,680,731', 2, 'PCS', 'C', 'Tidak Layak', '15-05-2025'],
                ['1120400500', 'TOOL, BORING & DRILL', 'Tools and Packing', 'IDR 12,564,290', 8, 'PCS', 'C', 'Baik', '10-04-2025'],
                ['1130300044', 'TOOL, POWER, 1/4 IN', 'Tools and Packing', 'IDR 45,230,124', 15, 'PCS', 'B', 'Rusak Minor', '20-03-2025'],
                ['1150100200', 'TUBE, STEEL, 2 IN OD', 'Tublr Gds, Valv&Fits', 'IDR 9,874,555', 22, 'M', 'C', 'Degradasi', '05-02-2025']
            ];

            const tableBody = document.getElementById('tableBody');
            tableData.forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${row[0]}</strong></td>
                    <td>${row[1]}</td>
                    <td>${row[2]}</td>
                    <td>${row[3]}</td>
                    <td>${row[4]}</td>
                    <td>${row[5]}</td>
                    <td><span class="badge badge-${row[6].toLowerCase()}">${row[6]}</span></td>
                    <td><span class="badge badge-${row[7] === 'Baik' ? 'good' : row[7] === 'Rusak Minor' ? 'warning' : 'danger'}">${row[7]}</span></td>
                    <td>${row[8]}</td>
                `;
                tableBody.appendChild(tr);
            });

            // Update time
            document.getElementById('updateTime').textContent = new Date().toLocaleDateString('id-ID', {
                year: 'numeric', month: '2-digit', day: '2-digit'
            }) + ' ' + new Date().toLocaleTimeString('id-ID');
        }

        // Export to Excel
        function exportToExcel() {
            let csv = 'Material Doc,Nama Material,Kategori,Nilai Total,Qty,Satuan,Kelas,Status,Inspeksi\n';
            const rows = document.querySelectorAll('table tbody tr');
            rows.forEach(row => {
                const cols = row.querySelectorAll('td');
                let csvRow = [];
                cols.forEach(col => {
                    csvRow.push(col.innerText);
                });
                csv += csvRow.join(',') + '\n';
            });

            const link = document.createElement('a');
            link.href = 'data:text/csv;charset=utf-8,' + encodeURI(csv);
            link.download = 'Dead_Stock_Export_' + new Date().toISOString().split('T')[0] + '.csv';
            link.click();
        }
    </script>
</body>
</html>
